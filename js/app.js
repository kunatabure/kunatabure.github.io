(function(t){function e(e){for(var a,r,o=e[0],c=e[1],l=e[2],h=0,p=[];h<o.length;h++)r=o[h],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var c=n[o];0!==s[c]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"5c0b":function(t,e,n){"use strict";n("9c0c")},"9c0c":function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"mode-"+this.$store.state.ui.mode,attrs:{id:"app"}},[n("TeiReader")],1)},i=[],r=n("d4ec"),o=n("bee2"),c=n("262e"),l=n("2caf"),u=n("9ab4"),h=n("1b40"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tei-reader"},[n("div",{class:this.$store.state.ui.smallMenuOpen?"small-menu-open":null},[t.isSmall&&t.isSmallMenuOpen?n("nav",{staticClass:"main"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]):t._e(),!t.isSmall&&t.hasMultipleSections||t.isSmall&&t.isSmallMenuOpen?n("nav",{staticClass:"main"},[n("ul",{attrs:{role:"menubar"}},[t._l(t.sections,(function(e,a){return n("li",{key:a,attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem","aria-checked":a===t.selectedSection?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(e){return t.selectSection(a)}}})])})),t.closeLabel&&t.closeCallback?n("li",{attrs:{role:"presentation"}},[n("a",{attrs:{role:"menuitem"},domProps:{innerHTML:t._s(t.closeLabel)},on:{click:t.close}})]):t._e()],2)]):t._e()]),t._l(t.sections,(function(e,a){return[a===t.selectedSection&&"Text"===e.type?n("text-reader",{key:a,attrs:{section:a}}):a===t.selectedSection&&"Metadata"===e.type?n("metadata-reader",{key:a,attrs:{section:a}}):a===t.selectedSection&&"NestedList"===e.type?n("nested-list-reader",{key:a,attrs:{section:a}}):t._e()]}))],2)},d=[],f=(n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"text-reader"},[t.isSmall&&(!t.isSmallMenuOpen||t.headings.length>0)?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",{staticClass:"main"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),t.headings.length>0?n("nav",{staticClass:"main vertical"},[n("ul",[t._l(t.headings,(function(e,a){return[e.target===t.activeHeading||!t.activeHeading&&0===a||t.isSmallMenuOpen?n("li",{key:a},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){t.isSmallMenuOpen?t.navigateTo(e):t.toggleSmallMenu()}}})]):t._e()]}))],2)]):n("nav",{staticClass:"main"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),!t.isSmall&&t.headings.length>0?n("nav",{staticClass:"headings vertical"},[n("ul",t._l(t.headings,(function(e,a){return n("li",{key:a},[n("a",{attrs:{"aria-checked":e.target===t.activeHeading?"true":"false"},domProps:{innerHTML:t._s(e.label)},on:{click:function(n){return t.navigateTo(e)}}})])})),0)]):t._e(),n("article",[n("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrollReader,expression:"scrollReader"}],domProps:{innerHTML:t._s(t.text)},on:{click:t.textClick}}),t.footnote?n("aside",[n("a",{on:{click:function(e){return t.hideFootnote(t.footnote[0])}}},[t._v("✖")]),n("text-node",{attrs:{section:t.section,node:t.footnote[1]}})],1):t._e()]),!t.isSmall&&t.hasSidebarAnnotations?n("aside",t._l(t.annotations,(function(e,a){var s=e[0],i=e[1];return n("section",{key:a},[n("a",{on:{click:function(e){return t.hideAnnotation(s)}}},[t._v("✖")]),i?n("text-node",{attrs:{section:t.section,node:i}}):t._e()],1)})),0):t._e()])}),v=[],m=(n("99af"),n("4de4"),n("4160"),n("a15b"),n("d81d"),n("fb6a"),n("b0c0"),n("4fad"),n("159b"),n("3835")),g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isReference?n("a",t._b({class:"node-"+t.node.type,on:{click:t.toggleReference}},"a",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2):t.isInline?n("span",t._b({class:"node-"+t.node.type},"span",t.nodeAttrs,!1),[t.node.text?n("span",[t._v(t._s(t.node.text))]):t._e(),t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2):n("div",t._b({class:"node-"+t.node.type},"div",t.nodeAttrs,!1),[t._l(t.node.content,(function(e,a){return["text"===e.type&&t.marks(e).length>0?n("span",t._b({key:a,class:t.marks(e)},"span",t.markAttrs(e),!1),[t._v(t._s(e.text))]):"text"===e.type?[t._v(t._s(e.text))]:n("text-node",{key:a,attrs:{section:t.section,node:e}})]}))],2)},b=[],y=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"marks",value:function(t){return t.marks?t.marks.map((function(t){return"mark-"+t.type})):[]}},{key:"markAttrs",value:function(t){if(t.marks){var e={};return t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var n=Object(m["a"])(t,2),a=n[0],s=n[1];s&&(e["data-"+a]=s)}))})),e}return{}}},{key:"toggleReference",value:function(){var t=this.typeDef;t&&this.isReference&&this.$props.node.attrs[t.reference.attr]&&(this.isSmall||"sidebar"!==t.reference.display?this.$store.commit("toggleFootnote",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}):this.$store.commit("toggleAnnotation",{path:this.$props.section+".nested."+t.reference.type+"."+this.$props.node.attrs[t.reference.attr].substring(1)}))}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"typeDef",get:function(){for(var t=this.$store.state.sections[this.$props.section].schema,e=0;e<t.length;e++)if(t[e].name===this.$props.node.type)return t[e];return null}},{key:"nodeAttrs",get:function(){var t={};return this.$props.node.attrs&&Object.entries(this.$props.node.attrs).forEach((function(e){var n=Object(m["a"])(e,2),a=n[0],s=n[1];s&&(t["data-"+a]=s)})),t}},{key:"isReference",get:function(){var t=this.typeDef;return!(!t||!t.reference)}},{key:"isInline",get:function(){var t=this.typeDef;return!(!t||"inline"!==t.type)}}]),n}(h["c"]);Object(u["a"])([Object(h["b"])()],y.prototype,"section",void 0),Object(u["a"])([Object(h["b"])()],y.prototype,"node",void 0),y=Object(u["a"])([Object(h["a"])({name:"text-node"})],y);var k=y,O=k,$=n("2877"),j=Object($["a"])(O,g,b,!1,null,null,null),x=j.exports;n("a9e3"),n("25eb"),n("ac1f"),n("1276");function S(t,e){var n=e.split(".");while(t&&n.length>0){if("["===n[0][0]&&"]"===n[0][n[0].length-1]){var a=Number.parseInt(n[0].substring(1,n[0].length-1));a>=0&&a<t.length&&(t=t[a])}else t=t[n[0]];n=n.slice(1)}return t}var _=n("4396"),M=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(r["a"])(this,n),t=e.apply(this,arguments),t.activeHeading="",t}return Object(o["a"])(n,[{key:"mounted",value:function(){this.docUpdated()}},{key:"hideAnnotation",value:function(t){this.$store.commit("toggleAnnotation",{path:t})}},{key:"hideFootnote",value:function(t){this.$store.commit("toggleFootnote",{path:t})}},{key:"navigateTo",value:function(t){var e=document.querySelector("[data-"+t.attr+'="'+t.target+'"]');if(e){var n=this.$el.querySelector("article > div");n&&Object(_["a"])(n.scrollTop,e.offsetTop,(function(t){n.scrollTop=t}))}this.isSmallMenuOpen&&this.toggleSmallMenu()}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"scrollReader",value:function(t,e){if(this&&this.$el){var n=window.localStorage.getItem("tei-reader"),a={};n&&(a=JSON.parse(n)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0),a[this.$store.state.ui.identifier][this.$props.section]=e.scrollTop,window.localStorage.setItem("tei-reader",JSON.stringify(a));var s=Array.prototype.slice.call(this.$el.querySelectorAll("[data-navigation-attr]")).filter((function(t){return t.getAttribute("data-"+t.getAttribute("data-navigation-attr"))}));if(s.length>0){if(this.activeHeading=null,e.scrollTop>0){var i=this.$el.querySelector("article");i&&(e.scrollTop=e.scrollTop+.25*i.clientHeight)}for(var r=0;r<s.length;r++){var o=s[r];if(r<s.length-1){var c=s[r+1];e.scrollTop>=o.offsetTop&&e.scrollTop<c.offsetTop&&(this.activeHeading=o.getAttribute("data-"+o.getAttribute("data-navigation-attr")))}else e.scrollTop>=o.offsetTop&&(this.activeHeading=o.getAttribute("data-"+o.getAttribute("data-navigation-attr")))}}}}},{key:"textClick",value:function(t){var e=t.target;while(e){if("a"===e.localName)break;e=e.parentElement}e&&e.getAttribute("data-reference-path")&&("sidebar"===e.getAttribute("data-reference-mode")?"small"===this.$store.state.ui.mode?this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}):this.$store.commit("toggleAnnotation",{path:e.getAttribute("data-reference-path")}):"footnote"===e.getAttribute("data-reference-mode")&&this.$store.commit("toggleFootnote",{path:e.getAttribute("data-reference-path")}))}},{key:"docUpdated",value:function(){var t=this,e=this.$el.querySelector("article > div");if(e.scrollTop=0,window.localStorage&&this.$store.state.ui.identifier&&this.$props.section){var n=window.localStorage.getItem("tei-reader"),a={};n&&(a=JSON.parse(n)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0);var s=this.$el.querySelector("article > div");h["c"].nextTick((function(){s.scrollTop=a[t.$store.state.ui.identifier][t.$props.section]})),window.localStorage.setItem("tei-reader",JSON.stringify(a))}}},{key:"nodeSchema",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null}},{key:"getText",value:function(t){var e=this;return"text"===t.type&&t.text?t.text:t.content?t.content.map((function(t){return e.getText(t)})).join(""):""}},{key:"generateHeadings",value:function(t,e,n){if(t){for(var a=0;a<e.length;a++)e[a].name===t.type&&e[a].navigation&&t.attrs&&t.attrs[e[a].navigation.attr]&&n.push({attr:e[a].navigation.attr,target:t.attrs[e[a].navigation.attr],label:this.getText(t)});if(t.content)for(var s=0;s<t.content.length;s++)this.generateHeadings(t.content[s],e,n)}}},{key:"generateHTML",value:function(t,e){var n=[];if(t){var a=this.nodeSchema(t.type,e);if(a){if("text"===a.name?t.marks&&(n.push('<span class="'),t.marks.forEach((function(t,e){e>0?n.push(" mark-"+t.type):n.push("mark-"+t.type)})),n.push('"'),t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')}))})),n.push(">")):a.reference?(n.push('<a class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),t.attrs&&a.reference&&a.reference.attr&&t.attrs[a.reference.attr]&&(n.push(' data-reference-path="'+this.$props.section+".nested."+a.reference.type+"."+t.attrs[a.reference.attr]+'"'),n.push(' data-reference-mode="'+a.reference.display+'"')),n.push(">")):"inline"===a.type?(n.push('<span class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),n.push(">")):(n.push('<div class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),a.navigation&&n.push(' data-navigation-attr="'+a.navigation.attr.toLowerCase()+'"'),n.push(">")),t.text&&n.push(t.text),t.content)for(var s=0;s<t.content.length;s++){var i=this.generateHTML(t.content[s],e);n=n.concat(i)}"text"===a.name?t.marks&&n.push("</span>"):a.reference?n.push("</a>"):"inline"===a.type?n.push("</span>"):n.push("</div>")}else if("doc"===t.type&&t.content)for(var r=0;r<t.content.length;r++){var o=this.generateHTML(t.content[r],e);n=n.concat(o)}}return n}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"doc",get:function(){var t=this.$store.state.content[this.$props.section];return t&&t.doc?t.doc:null}},{key:"hasSidebarAnnotations",get:function(){for(var t=this.$store.state.sections[this.$props.section].schema,e=0;e<t.length;e++)if(t[e].reference&&"sidebar"===t[e].reference.display)return!0;return!1}},{key:"annotations",get:function(){var t=this;return this.$store.state.ui.sections[this.$props.section].annotations.map((function(e){var n=S(t.$store.state.content,e);return n?[e,n.content[0]]:null}))}},{key:"footnote",get:function(){var t=this.$store.state.ui.sections[this.$props.section].footnote;if(t){var e=S(this.$store.state.content,t);if(e)return[t,e.content[0]]}return null}},{key:"headings",get:function(){if(this.doc){var t=this.$store.state.sections[this.$props.section].schema,e=[];return this.generateHeadings(this.doc,t,e),e}return[]}},{key:"schema",get:function(){return this.$store.state.sections[this.$props.section].schema}},{key:"text",get:function(){return this.generateHTML(this.doc,this.schema).join("")}}]),n}(h["c"]);Object(u["a"])([Object(h["b"])()],M.prototype,"section",void 0),Object(u["a"])([Object(h["d"])("doc")],M.prototype,"docUpdated",null),M=Object(u["a"])([Object(h["a"])({components:{TextNode:x}})],M);var T=M,w=T,E=Object($["a"])(w,f,v,!1,null,null,null),N=E.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"metadata-reader"},[t.isSmall&&!t.isSmallMenuOpen?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"vertical"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),t._l(t.metadataGroups,(function(e,a){return n("section",{key:a},[n("h2",[t._v(t._s(e.label))]),t._l(e.entries,(function(e,a){return n("metadata-field",{key:a,attrs:{section:t.section,config:e,parent:""}})}))],2)}))],2)},A=[],C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["single-text"==t.config.type?[n("span",{staticClass:"field"},[n("span",{staticClass:"label"},[t._v(t._s(t.config.label))]),n("span",{staticClass:"value"},[t._v(t._s(t.value))])])]:t._e(),"multi-row"==t.config.type?[n("ol",{staticClass:"multi-row"},t._l(t.value,(function(e,a){return n("li",{key:a},t._l(t.config.entries,(function(e,s){return n("metadata-field",{key:s,attrs:{section:t.section,config:e,parent:t.parent+t.config.path+".["+a+"]"}})})),1)})),0)]:t._e(),"multi-field"==t.config.type?[n("ol",{staticClass:"multi-field"},t._l(t.config.entries,(function(e,a){return n("li",{key:a},[n("metadata-field",{attrs:{section:t.section,config:e,parent:t.parent+t.config.path}})],1)})),0)]:t._e()],2)},R=[],L=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"value",get:function(){var t=S(this.$store.state.content[this.$props.section],this.$props.parent+this.$props.config.path);return t||""}}]),n}(h["c"]);Object(u["a"])([Object(h["b"])()],L.prototype,"config",void 0),Object(u["a"])([Object(h["b"])()],L.prototype,"section",void 0),Object(u["a"])([Object(h["b"])()],L.prototype,"parent",void 0),L=Object(u["a"])([Object(h["a"])({name:"metadata-field"})],L);var H=L,I=H,P=Object($["a"])(I,C,R,!1,null,null,null),V=P.exports,J=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"metadataGroups",get:function(){return this.$store.state.sections[this.$props.section].ui}}]),n}(h["c"]);Object(u["a"])([Object(h["b"])()],J.prototype,"section",void 0),J=Object(u["a"])([Object(h["a"])({components:{MetadataField:V}})],J);var q=J,F=q,U=Object($["a"])(F,D,A,!1,null,null,null),z=U.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"nested-list-reader"},[t.isSmall&&!t.isSmallMenuOpen?n("div",{class:t.isSmallMenuOpen?"small-menu-open":null},[n("nav",{staticClass:"main"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v("☰")])])])]),n("nav",{staticClass:"main vertical"},[n("ul",[n("li",[n("a",{on:{click:t.toggleSmallMenu}},[t._v(t._s(t.$store.state.sections[t.section].label))])])])])]):t._e(),n("article",[n("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.scrollReader,expression:"scrollReader"}],domProps:{innerHTML:t._s(t.text)},on:{click:t.textClick}})])])},W=[],Y=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(r["a"])(this,n),t=e.apply(this,arguments),t.activeHeading="",t}return Object(o["a"])(n,[{key:"mounted",value:function(){this.docUpdated()}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"scrollReader",value:function(t,e){if(this&&this.$el){var n=window.localStorage.getItem("tei-reader"),a={};n&&(a=JSON.parse(n)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0),a[this.$store.state.ui.identifier][this.$props.section]=e.scrollTop,window.localStorage.setItem("tei-reader",JSON.stringify(a))}}},{key:"textClick",value:function(t){var e=t.target;while(e){if("a"===e.localName)break;e=e.parentElement}var n=e.getAttribute("data-reference-path");if(e&&n){var a=n.split(".");if(a.length>0&&a[0]===this.sectionData.source&&a[2]==this.sectionData.nodeName){var s=this.$el.querySelector("article > div"),i=this.$el.querySelector("#"+a[3]);s&&i&&Object(_["a"])(s.scrollTop,i.offsetTop,(function(t){s.scrollTop=t}))}}}},{key:"docUpdated",value:function(){var t=this,e=this.$el.querySelector("article > div");if(e.scrollTop=0,window.localStorage&&this.$store.state.ui.identifier&&this.$props.section){var n=window.localStorage.getItem("tei-reader"),a={};n&&(a=JSON.parse(n)),a[this.$store.state.ui.identifier]||(a[this.$store.state.ui.identifier]={}),a[this.$store.state.ui.identifier][this.$props.section]||(a[this.$store.state.ui.identifier][this.$props.section]=0);var s=this.$el.querySelector("article > div");h["c"].nextTick((function(){s.scrollTop=a[t.$store.state.ui.identifier][t.$props.section]})),window.localStorage.setItem("tei-reader",JSON.stringify(a))}}},{key:"nodeSchema",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].name===t)return e[n];return null}},{key:"getText",value:function(t){var e=this;return"text"===t.type&&t.text?t.text:t.content?t.content.map((function(t){return e.getText(t)})).join(""):""}},{key:"generateHTML",value:function(t,e){var n=[];if(t){var a=this.nodeSchema(t.type,e);if(a){if("text"===a.name?t.marks&&(n.push('<span class="'),t.marks.forEach((function(t,e){e>0?n.push(" mark-"+t.type):n.push("mark-"+t.type)})),n.push('"'),t.marks.forEach((function(t){t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')}))})),n.push(">")):a.reference?(n.push('<a class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),t.attrs&&a.reference&&a.reference.attr&&t.attrs[a.reference.attr]&&(n.push(' data-reference-path="'+this.$props.section+".nested."+a.reference.type+"."+t.attrs[a.reference.attr].substring(1)+'"'),n.push(' data-reference-mode="'+a.reference.display+'"')),n.push(">")):"inline"===a.type?(n.push('<span class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),n.push(">")):(n.push('<div class="node-'+t.type+'"'),t.attrs&&Object.entries(t.attrs).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];n.push(" data-"+a+'="'+s+'"')})),n.push(">")),t.text&&n.push(t.text),t.content)for(var s=0;s<t.content.length;s++){var i=this.generateHTML(t.content[s],e);n=n.concat(i)}"text"===a.name?t.marks&&n.push("</span>"):a.reference?n.push("</a>"):"inline"===a.type?n.push("</span>"):n.push("</div>")}else if("doc"===t.type&&t.content)for(var r=0;r<t.content.length;r++){var o=this.generateHTML(t.content[r],e);n=n.concat(o)}}return n}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"sectionData",get:function(){return this.$store.state.sections[this.$props.section]}},{key:"docs",get:function(){var t=this.$store.state.content[this.sectionData.source];return t&&t.nested&&t.nested[this.sectionData.nodeName]?t.nested[this.sectionData.nodeName]:null}},{key:"schema",get:function(){return this.$store.state.sections[this.sectionData.source].schema}},{key:"text",get:function(){var t=this;if(this.docs){var e=["<ol>"];return Object.entries(this.docs).forEach((function(n){var a=Object(m["a"])(n,2),s=a[0],i=a[1];i.content&&i.content.length>0&&(e.push('<li id="'+s+'">'),e=e.concat(t.generateHTML(i.content[0],t.schema)),e.push("</li>"))})),e.push("</ol>"),e.join("")}return null}}]),n}(h["c"]);Object(u["a"])([Object(h["b"])()],Y.prototype,"section",void 0),Object(u["a"])([Object(h["d"])("doc")],Y.prototype,"docUpdated",null),Y=Object(u["a"])([Object(h["a"])({components:{TextNode:x}})],Y);var B=Y,G=B,K=Object($["a"])(G,X,W,!1,null,null,null),Q=K.exports,Z=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"selectSection",value:function(t){this.$store.commit("selectSection",t),this.isSmall&&this.$store.commit("toggleSmallMenu")}},{key:"toggleSmallMenu",value:function(){this.$store.commit("toggleSmallMenu")}},{key:"close",value:function(){this.isSmall&&this.$store.commit("toggleSmallMenu"),this.closeCallback()}},{key:"isSmall",get:function(){return"small"===this.$store.state.ui.mode}},{key:"isSmallMenuOpen",get:function(){return this.$store.state.ui.smallMenuOpen}},{key:"hasMultipleSections",get:function(){return Object.keys(this.$store.state.sections).length>1}},{key:"sections",get:function(){return this.$store.state.sections}},{key:"selectedSection",get:function(){return this.$store.state.ui.selectedSection}},{key:"closeLabel",get:function(){return this.$store.state.ui.closeLabel}},{key:"closeCallback",get:function(){return this.$store.state.callbacks.close}}]),n}(h["c"]);Z=Object(u["a"])([Object(h["a"])({components:{TextReader:N,MetadataReader:z,NestedListReader:Q}})],Z);var tt=Z,et=tt,nt=Object($["a"])(et,p,d,!1,null,null,null),at=nt.exports,st=function(t){Object(c["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(r["a"])(this,n),e.apply(this,arguments)}return Object(o["a"])(n,[{key:"mounted",value:function(){var t=this,e=document.getElementById("TEIReaderConfig");if(e){var n=JSON.parse(e.innerHTML);n&&this.$store.commit("init",n)}this.$store.state.callbacks&&this.$store.state.callbacks.autoLoad&&this.$store.state.callbacks.autoLoad((function(e){t.$store.dispatch("load",e)})),this.updateWindowSize(),window.addEventListener("resize",this.updateWindowSize)}},{key:"beforeDestroy",value:function(){window.removeEventListener("resize",this.updateWindowSize)}},{key:"updateWindowSize",value:function(){window.innerWidth<1024?this.$store.commit("setMode","small"):this.$store.commit("setMode","large")}}]),n}(h["c"]);st=Object(u["a"])([Object(h["a"])({components:{TeiReader:at}})],st);var it=st,rt=it,ot=(n("5c0b"),Object($["a"])(rt,s,i,!1,null,null,null)),ct=ot.exports,lt=(n("c975"),n("a434"),n("2f62"));function ut(t){return"tei"===t?"http://www.tei-c.org/ns/1.0":"xml"===t?"http://www.w3.org/XML/1998/namespace":"http://www.tei-c.org/ns/1.0"}var ht=function(){function t(e){Object(r["a"])(this,t),this.dom=e}return Object(o["a"])(t,[{key:"evaluate",value:function(t,e,n){return this.dom.evaluate(e,t,ut,n,null)}},{key:"firstNode",value:function(t,e){return this.evaluate(t,e,XPathResult.FIRST_ORDERED_NODE_TYPE).singleNodeValue}},{key:"nodeIterator",value:function(t,e){return this.evaluate(t,e,XPathResult.ORDERED_NODE_ITERATOR_TYPE)}},{key:"stringValue",value:function(t,e){return this.evaluate(t,e,XPathResult.STRING_TYPE).stringValue}},{key:"booleanValue",value:function(t,e){return this.evaluate(t,e,XPathResult.BOOLEAN_TYPE).booleanValue}},{key:"numberValue",value:function(t,e){return this.evaluate(t,e,XPathResult.NUMBER_TYPE).numberValue}}]),t}(),pt=function(){function t(e,n){Object(r["a"])(this,t),this.dom=e,this.xpath=new ht(this.dom),this.config=n}return Object(o["a"])(t,[{key:"get",value:function(){if(!this.data){var t=this.xpath.firstNode(this.dom.documentElement,"/tei:TEI/tei:teiHeader");this.data={};for(var e=0;e<this.config.schema.length;e++){var n=this.parseHeaderNode(t,this.config.schema[e]);n&&(this.data[this.config.schema[e].tag.substring(4)]=n)}}return this.data}},{key:"parseHeaderNode",value:function(t,e){var n=this.xpath.nodeIterator(t,e.tag),a=[],s=n.iterateNext();while(s){for(var i={_attrs:{},_text:0===s.children.length?this.xpath.stringValue(s,"text()"):null},r=0;r<s.attributes.length;r++)i._attrs[s.attributes[r].name]=s.attributes[r].value;if(e.children)for(var o=0;o<e.children.length;o++){var c=this.parseHeaderNode(s,e.children[o]);c&&(i[e.children[o].tag.substring(e.children[o].tag.indexOf(":")+1)]=c)}a.push(i),s=n.iterateNext()}return 0===a.length?null:e.multiple?a:a[0]}}]),t}(),dt=function(){function t(e,n){Object(r["a"])(this,t),this.doc=null,this.nestedDocs={},this.dom=e,this.xpath=new ht(this.dom),this.config=n}return Object(o["a"])(t,[{key:"get",value:function(){if(!this.doc&&(this.doc={type:"doc",content:[]},this.nestedDocs={},this.config.parser&&this.config.parser.selector)){var t=this.xpath.firstNode(this.dom.documentElement,this.config.parser.selector);if(t)for(var e=0;e<t.children.length;e++){var n=this.parseContentNode(t.children[e],this.config);n&&!n.nestedDoc&&this.doc.content?this.doc.content.push(n):n&&n.nestedDoc&&this.addNestedDoc(n)}}return[this.doc,this.nestedDocs]}},{key:"parseContentAttributes",value:function(t,e){var n=this,a={};return Object.entries(e).forEach((function(e){var s=Object(m["a"])(e,2),i=s[0],r=s[1],o=[];r.parser?o.push(r.parser):r.parsers&&(o=r.parsers);for(var c=0;c<o.length;c++){var l=o[c];if("boolean"===l.type)a[i]=n.xpath.booleanValue(t,l.selector);else if("number"===l.type)try{a[i]=n.xpath.numberValue(t,l.selector)}catch(h){console.log(h)}else if("static"===l.type)n.xpath.booleanValue(t,l.selector)&&(a[i]=l.value);else try{var u=n.xpath.stringValue(t,l.selector);u&&(a[i]=u)}catch(h){console.log(h)}}})),a}},{key:"parseContentMarks",value:function(t,e){var n=this,a=[];return e.forEach((function(e){if("mark"===e.type){var s=[];e.parser?s.push(e.parser):e.parsers&&(s=e.parsers);for(var i=0;i<s.length;i++)if(n.xpath.booleanValue(t,s[i].selector)){var r={type:e.name};e.attrs&&(r.attrs=n.parseContentAttributes(t,e.attrs)),a.push(r)}}})),a}},{key:"parseContentNode",value:function(t,e){for(var n=Object.entries(e.schema),a=0;a<n.length;a++){var s=n[a][1],i=[];s.parser?i.push(s.parser):s.parsers&&(i=i.concat(s.parsers));for(var r=0;r<i.length;r++){var o=i[r];if(null!==this.xpath.firstNode(t,"self::"+o.selector)){var c={type:s.name};if(s.attrs&&(c.attrs=this.parseContentAttributes(t,s.attrs)),"nested"===s.type&&(c.nestedDoc=!0),"inline"===s.type)if("text"===s.name){if(o.text&&(c.text=this.xpath.stringValue(t,o.text)),c.marks=this.parseContentMarks(t,e.schema),1===t.children.length){var l=this.parseContentNode(t.children[0],e);l&&l.text&&""!==l.text&&(c.text=l.text),l&&l.marks&&(c.marks=c.marks.concat(l.marks))}}else if(0===t.children.length)o.text&&this.xpath.stringValue(t,o.text)&&(c.content=[{type:"text",text:this.xpath.stringValue(t,o.text),marks:this.parseContentMarks(t,e.schema)}]);else{for(var u=[],h=0;h<t.children.length;h++){var p=this.parseContentNode(t.children[h],e);p&&u.push(p)}c.content=u}else{for(var d=[],f=0;f<t.children.length;f++){var v=this.parseContentNode(t.children[f],e);v&&!v.nestedDoc?d.push(v):v&&v.nestedDoc&&this.addNestedDoc(v)}c.content=d}return c}}}return null}},{key:"addNestedDoc",value:function(t){if(t.attrs&&t.attrs.id){this.nestedDocs[t.type]||(this.nestedDocs[t.type]={}),this.nestedDocs[t.type][t.attrs.id]=t;var e={type:"doc",content:t.content};t.content=[e]}}}]),t}(),ft=n("53ca");function vt(t){if(void 0!==t){if(null===t)return null;if(Array.isArray(t))return t.map((function(t){return vt(t)}));if("object"===Object(ft["a"])(t)){var e={};return Object.keys(t).forEach((function(n){e[n]=vt(t[n])})),e}return t}}a["a"].use(lt["a"]);var mt=new lt["a"].Store({state:{content:{},callbacks:{},sections:{},ui:{mode:"small",smallMenuOpen:!1,selectedSection:null,sections:{},closeLabel:null,identifier:""}},mutations:{init:function(t,e){t.sections=e.sections,Object.keys(e.sections).forEach((function(n,s){a["a"].set(t.content,n,{}),"Text"===e.sections[n].type&&(a["a"].set(t.content[n],"doc",null),a["a"].set(t.content[n],"nested",{})),a["a"].set(t.ui.sections,n,{}),"Text"===e.sections[n].type&&(a["a"].set(t.ui.sections[n],"annotations",[]),a["a"].set(t.ui.sections[n],"footnote",null)),0===s&&(t.ui.selectedSection=n)})),window.TEIReader&&window.TEIReader.callbacks&&(a["a"].set(t.callbacks,"autoLoad",window.TEIReader.callbacks.autoLoad),a["a"].set(t.callbacks,"close",window.TEIReader.callbacks.close)),e.ui&&e.ui.closeLabel&&(t.ui.closeLabel=e.ui.closeLabel)},setTextDoc:function(t,e){var n=e.path.split(".");2===n.length?a["a"].set(t.content[n[0]],n[1],e.doc):4===n.length&&a["a"].set(t.content[n[0]].nested[n[2]][n[3]],"content",[e.doc])},addNestedDoc:function(t,e){var n=e.path.split(".");4===n.length&&(t.content[n[0]].nested[n[2]]||a["a"].set(t.content[n[0]].nested,n[2],{}),a["a"].set(t.content[n[0]].nested[n[2]],n[3],{attrs:{id:n[3]},content:[e.doc],nestedDoc:!0,type:n[2]}))},setMetadata:function(t,e){a["a"].set(t.content,e.path,e.metadata)},selectSection:function(t,e){t.ui.selectedSection=e},toggleAnnotation:function(t,e){var n=e.path.split(".");if(4===n.length){var s=vt(t.ui.sections[n[0]].annotations);s.indexOf(e.path)>=0?s.splice(s.indexOf(e.path),1):s.push(e.path),a["a"].set(t.ui.sections[n[0]],"annotations",s)}},toggleFootnote:function(t,e){var n=e.path.split(".");4===n.length&&(t.ui.sections[n[0]].footnote===e.path?a["a"].set(t.ui.sections[n[0]],"footnote",null):a["a"].set(t.ui.sections[n[0]],"footnote",e.path))},toggleSmallMenu:function(t){t.ui.smallMenuOpen=!t.ui.smallMenuOpen},setMode:function(t,e){t.ui.mode=e},setDocIdentifier:function(t,e){t.ui.identifier=e}},actions:{load:function(t,e){var n=t.commit,s=t.state;n("setDocIdentifier",e.identifier);var i=new DOMParser,r=i.parseFromString(e.content,"application/xml");a["a"].set(s,"content",{}),Object.keys(s.sections).forEach((function(t){a["a"].set(s.content,t,{}),a["a"].set(s.content[t],"doc",null),a["a"].set(s.content[t],"nested",{})})),Object.entries(s.sections).forEach((function(t){var e=Object(m["a"])(t,2),a=e[0],s=e[1];if("Metadata"===s.type)n("setMetadata",{path:a,metadata:new pt(r,s).get()});else if("Text"===s.type){var i=new dt(r,s).get(),o=Object(m["a"])(i,2),c=o[0],l=o[1];n("setTextDoc",{path:a+".doc",doc:c}),Object.entries(l).forEach((function(t){var e=Object(m["a"])(t,2),s=e[0],i=e[1];Object.entries(i).forEach((function(t){var e=Object(m["a"])(t,2),i=e[0],r=e[1];r.content&&n("addNestedDoc",{path:a+".nested."+s+"."+i,doc:r.content[0]})}))}))}}))}},modules:{}}),gt=n("b9dd");a["a"].use(gt["a"],{debounce:50}),a["a"].config.productionTip=!1,new a["a"]({store:mt,render:function(t){return t(ct)}}).$mount("#app")}});
//# sourceMappingURL=app.js.map